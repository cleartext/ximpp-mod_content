[{"contains", fun(Msg, Phrase, _Host) ->
                string:str(Msg, Phrase) > 0
              end
 },

 {"equals", fun(Msg, Phrase) ->
                Msg =:= Phrase
            end
 },

 {"contains_all", fun(Msg, Words, _Host) ->
                    WordList = string:tokens(Words, ";"),
                    lists:all(fun(W) -> string:str(Msg, W) > 0 end, WordList)
                  end
 },

 {"contains_any", fun(Msg, Words, _Host) ->
                    WordList = string:tokens(Words, ";"),
                    lists:any(fun(W) -> string:str(Msg, W) > 0 end, WordList)
                  end
 },

 {"check_urls", fun(Msg, ScoreThreshold, Host) ->
                    URLs = webroot_utils:extract_urls(Msg),
					T = list_to_integer(ScoreThreshold), 
					Scores = webroot_utils:get_scores(Host, URLs),
					lists:any(fun(S) -> S >= T end, Scores)	
				end
 }
].
